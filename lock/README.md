分布式锁实现


1.zk
1.1 原理
    zookeeper其实是集群中每个节点都维护着一棵相同的树, 即zookeeper集群的每个节点的数据都是一致的，树的结构跟linux的目录结构的概念差不多, 以/为跟节点, 下边可以扩展任意的节点和叶子节点, 每个节点都可以写入数据.
    

在zookeeper中创建一个根节点（Locks），用于后续各个客户端的锁操作


(1) 获取锁的过程
想要获取锁的client都在Locks中创建一个自增序的子节点，每个client得到一个序号，相当于排队如果自己的序号是最小的，就成功获得锁，如果不是最小的，就关注自己前面的那个序号，发现前面那个走了以后，就轮到自己了

(2) 释放锁的过程
将自己对应的节点删除即可，下一个排队的节点就可以收到通知，从而被唤醒得到锁。例如client A需要释放锁，只需要把对应的节点1删除掉，因为client B已经关注了节点1，那么当节点1被删除后，zookeeper就会通知client B：你是序号最小的了，可以获取锁了


